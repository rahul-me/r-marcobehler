{
   "definitions":{
      "channelIdentifier":{
         "type":"object",
         "properties":{
            "salesChannelCode":{
               "type":"string"
            },
            "agentCode":{
               "type":"string"
            },
            "agentUser":{
               "type":"string"
            },
            "partnerCode":{
               "type":"string"
            },
            "campaignCode":{
               "type":"string"
            }
         },
         "required":[
            "salesChannelCode",
            "agentCode",
            "agentUser",
            "partnerCode",
            "campaignCode"
         ]
      },
      "leadPassenger":{
         "type":"object",
         "properties":{
            "title":{
               "type":"string"
            },
            "firstName":{
               "type":"string"
            },
            "surname":{
               "type":"string"
            },
            "telephone":{
               "type":"string"
            },
            "postOutConsent":{
               "type":[
                  "string",
                  "null"
               ]
            },
            "emailConsent":{
               "type":[
                  "string",
                  "null"
               ]
            },
            "telephoneConsent":{
               "type":[
                  "string",
                  "null"
               ]
            },
            "address":{
               "type":"object",
               "properties":{
                  "address1":{
                     "type":"string"
                  },
                  "address2":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "address3":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "town":{
                     "type":"string"
                  },
                  "county":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "postcode":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "country":{
                     "type":[
                        "string",
                        "null"
                     ]
                  }
               },
               "required":[
                  "address1",
                  "town"
               ]
            }
         },
         "required":[
            "title",
            "firstName",
            "surname",
            "telephone",
            "address"
         ]
      },
      "distributionDetails":{
         "type":"object",
         "properties":{
            "distributionType":{
               "type":"string"
            },
            "email":{
               "type":"string"
            }
         },
         "allOf":[
            {
               "if":{
                  "properties":{
                     "distributionType":{
                        "const":"E TICKET"
                     }
                  }
               },
               "then":{
                  "properties":{
                     "email":{
                        "type":"string"
                     }
                  },
                  "required":[
                     "email"
                  ]
               },
               "else":{
                  
               }
            },
            {
               "if":{
                  "properties":{
                     "distributionType":{
                        "const":"M TICKET"
                     }
                  }
               },
               "then":{
                  "properties":{
                     "mTicketPhone":{
                        "type":"string",
                        "minLength":1
                     }
                  },
                  "required":[
                     "mTicketPhone"
                  ]
               },
               "else":{
                  
               }
            },
            {
               "if":{
                  "properties":{
                     "distributionType":{
                        "const":"REMOTE COLLECT"
                     }
                  }
               },
               "then":{
                  "properties":{
                     "collectionLocation":{
                        "type":"string"
                     }
                  },
                  "required":[
                     "collectionLocation"
                  ]
               },
               "else":{
                  
               }
            },
            {
               "if":{
                  "properties":{
                     "distributionType":{
                        "const":"Local Post Out"
                     }
                  }
               },
               "then":{
                  "properties":{
                     "postalAddress":{
                        "type":"object",
                        "properties":{
                           "address1":{
                              "type":"string"
                           },
                           "address2":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "address3":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "town":{
                              "type":"string"
                           },
                           "county":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "postcode":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "country":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           }
                        },
                        "required":[
                           "address1",
                           "town"
                        ]
                     }
                  }
               },
               "else":{
                  
               }
            }
         ],
         "required":[
            "distributionType"
         ]
      },
      "addons":{
         "type":"array",
         "items":{
            "sku":"string",
            "itemValue":"number",
            "itemQuantity":"number",
            "serial":[
               "string",
               "null"
            ],
            "validFrom":[
               "string",
               "null"
            ],
            "validTo":[
               "string",
               "null"
            ],
            "overrideReasonCode":[
               "string",
               "null"
            ],
            "oldFare":[
               "number",
               "null"
            ],
            "newFare":[
               "number",
               "null"
            ],
            "overrideDescription":[
               "string",
               "null"
            ],
            "firstName":"string",
            "surName":"string",
            "emailAddress":"string"
         },
         "required":[
            "sku",
            "itemValue",
            "itemQuantity"
         ]
      },
      "paymentDetails":{
         "type":"object",
         "properties":{
            "paymentValue":{
               "type":"number"
            },
            "paymentType":{
               "type":"string"
            },
            "billingAddress":{
               "type":"object",
               "properties":{
                  "address1":{
                     "type":"string"
                  },
                  "address2":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "address3":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "town":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "county":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "postcode":{
                     "type":[
                        "string",
                        "null"
                     ]
                  },
                  "country":{
                     "type":[
                        "string",
                        "null"
                     ]
                  }
               },
               "required":[
                  "address1",
                  "town"
               ]
            }
         },
         "allOf":[
            {
               "if":{
                  "properties":{
                     "paymentType":{
                        "const":"Card"
                     }
                  }
               },
               "then":{
                  "properties":{
                     "cardPayment":{
                        "type":"object",
                        "properties":{
                           "paymentProviderTransactionId":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "cardType":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "paymentProvider":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "merchantId":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "terminalId":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "authorisationCode":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "last4Digits":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           },
                           "transactionId":{
                              "type":[
                                 "string",
                                 "null"
                              ]
                           }
                        },
                        "required":[
                           "paymentProviderTransactionId",
                           "cardType",
                           "paymentProvider"
                        ]
                     }
                  }
               },
               "else":{
                  
               }
            }
         ],
         "required":[
            "paymentValue",
            "paymentType",
            "cardPayment",
            "billingAddress"
         ]
      }
   },
   "type":"object",
   "required":[
      "channelIdentifier",
      "otherProductPurchaseRequest"
   ],
   "properties":{
      "channelIdentifier":{
         "$ref":"#/definitions/channelIdentifier"
      },
      "otherProductPurchaseRequest":{
         "type":"object",
         "properties":{
            "ticketNumber":{
               "type":"string"
            },
            "leadPassenger":{
               "$ref":"#/definitions/leadPassenger"
            },
            "distributionDetails":{
               "$ref":"#/definitions/distributionDetails"
            },
            "addons":{
               "$ref":"#/definitions/addons"
            },
            "paymentDetails":{
               "$ref":"#/definitions/paymentDetails"
            },
            "discounts":{
               "$ref":"#/definitions/discounts"
            }
         },
         "required":[
            "ticketNumber",
            "leadPassenger",
            "addons",
            "distributionDetails",
            "paymentDetails"
         ]
      }
   }
}